<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="utf-8">
    <title>
    </title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js" type="text/javascript"></script>
    <script type="text/javascript">

      function grabTags() {
        MakeAPI.search({
          "query": {
            "terms": {
              "tags": document.getElementById( "tags-single" ).value.split( "," ),
              "minimum_match": 1
            }
          },
          size: 100
        });
      }

      function myProjects() {console.log(document.querySelector( "input[name='execution']:checked" ).value)
        MakeAPI.search({
          "query": {
            "filtered": {
              "query": {
                "field": { "author": document.getElementById( "author" ).value }
              },
              "filter": {
                "and": [
                  {
                    "terms": {
                      "tags": document.getElementById( "tags-multiple" ).value.split( "," ),
                      "execution": document.querySelector( "input[name='execution']:checked" ).value
                    }
                  }
                ]
              }
            }
          },
          size: document.getElementById( "size" ).value
        });
      }

      var MakeAPI = {
        search: function( data ) {console.log(data)
          var xhr = new XMLHttpRequest();

          xhr.open( "POST", "/api/makes/search", true );
          xhr.onreadystatechange = function() {
            if ( this.readyState === 4 ) {
              var data = JSON.parse( this.responseText );
              console.log(data.hits)
            }
          };
          xhr.setRequestHeader( "Content-Type", "application/json; charset=utf-8" );
          xhr.send( JSON.stringify( data ) );
        }
      };

    </script>

  </head>

  <body>
    All inputs accept CSV for multiple search terms<br><br>
    Tags<input type="text" id="tags-single"/><br><br>

    <input type="button" onclick="grabTags();" value="Search Tags"/>

    <br><br><br>
    Tags<input type="text" id="tags-multiple"/><br><br>
    Author (not CSV)<input type="text" id="author"/><br><br>
    Num<input type="number" id="size" /><br>
    Execution:<br>
    And<input type="radio" name="execution" value="and" checked/>
    Or<input type="radio" name="execution" value="bool" />

    <input type="button" onclick="myProjects();" value="Search My Projects"/>
  </body>
</html>


